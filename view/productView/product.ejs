<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chủ</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="icon" type="image/x-icon" href="/public/assets/favicon.ico">
    <style>
        .card {
            margin-bottom: 20px;
        }

        .card-body {
            text-align: center;
        }

        .jumbotron {
            background-color: #f8f9fa;
            padding: 2rem 1rem;
        }

        .jumbotron h1 {
            display: inline-block;
            font-family: 'Lucida Handwriting', cursive;
            font-size: 3rem;
            font-weight: bold;
            color: #198754;
        }

        .jumbotron h2 {
            display: inline-block;
            font-family: 'Arial', sans-serif;
            font-size: 2rem;
            font-weight: bold;
            color: #39181c;
            margin-left: 5px;
        }

        .jumbotron p {
            font-family: 'Arial', sans-serif;
            font-size: 1.5rem;
            color: #6c757d;
        }

        .mr {
            margin-right: 10px;
        }

        .card {
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(25, 135, 84, 1.0);
        }
    </style>
</head>

<body>
    <%- include('../layouts/nav'); %>
        <div class="container py-5">
            <div class="container col-md-12 bg-light p-3 my-3 border border-success-subtle rounded-4 shadow-lg">
                <form action="" class="row product-form">
                    <div class="col-md-4">
                        <img src="" alt="Image" class="img-fluid" id="productImage">
                    </div>
                    <div class="col-md-8 row">
                        <h2 id ="tag">Tên sản phẩm</h2>
                        <div class="col-md-6">
                            <div id="productId">Mã sản phẩm: </div>
                            <div id="productName">Tên: </div>
                            <div id="productAddress">Địa chỉ: </div>
                            <div id="unit">Đơn vị: </div>
                            <div id="numberInStorage">Số lượng trong kho: </div>
                            <div class="float-end py-5">
                                <button type="button" class="btn btn-danger">Chỉnh sửa</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div id="company">Công ty: </div>
                            <div id="purchasePrice">Giá nhập: </div>
                            <div id="sellingPrice">Giá bán: </div>
                            <div id="soldCount">Số lượng đã bán: </div>
                            <div id="productTypeId">Mã loại sản phẩm: </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        </div>
        <% productId %>
            <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
            <script>
                document.addEventListener("DOMContentLoaded", () => {
                    const productForm = document.querySelector(".product-form");

                    if (productForm) {
                        var productIdd = "<%- productId %>";
                        console.log(productIdd);

                        productForm.addEventListener("submit", function (event) {
                            event.preventDefault();
                        });


                       
                        fetch(`http://localhost:3000/product/getProductById/${productIdd}`)
                                .then((response) => {
                                    return response.json();
                                })
                                .then((productData) => {        
                                    var product = productData[0];
                                    console.log(product);
                                    if (product) {
                                        // Cập nhật DOM với dữ liệu được trích xuất
                                        // Em mở màn hình bên kia ok anh hehe
                                        document.getElementById("tag").innerText = `${product.productName ?? ""}`;
                                        document.getElementById("productImage").src = "/" + product.image;
                                        console.log("../" + product.image);
                                        document.getElementById("productId").innerText = `Mã sản phẩm: ${product.productId ?? ""}`;
                                        document.getElementById("productName").innerText = `Tên: ${product.productName ?? ""}`;
                                        document.getElementById("productAddress").innerText = `Địa chỉ: ${product.productAddress ?? ""}`;
                                        document.getElementById("unit").innerText = `Đơn vị: ${product.unit ?? ""}`;
                                        document.getElementById("numberInStorage").innerText = `Số lượng trong kho: ${product.numberInStorage ?? ""}`;
                                        document.getElementById("company").innerText = `Công ty: ${product.company ?? ""}`;
                                        document.getElementById("purchasePrice").innerText = `Giá nhập: ${product.purchasePrice ?? ""}`;
                                        document.getElementById("sellingPrice").innerText = `Giá bán: ${product.sellingPrice ?? ""}`;
                                        document.getElementById("soldCount").innerText = `Số lượng đã bán: ${product.soldCount ?? ""}`;
                                        document.getElementById("productTypeId").innerText = `Mã loại sản phẩm: ${product.productTypeId ?? ""}`;
                                    }
                                })
                                .catch((error) => {
                                    console.error('Lỗi khi truy xuất dữ liệu sản phẩm:', error);
                                });
                        

                    } else {
                        window.location.href = "/error";
                    }
                });
            </script>


</body>

</html>